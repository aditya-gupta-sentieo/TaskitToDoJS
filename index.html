<!doctype html>

<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taskit</title>
    <meta name="description" content="To-do list in JS">
    <meta name="author" content="Aditya">

    <link rel="stylesheet" href="styles.css">

  </head>

  <body>
    <header class="header" role="banner">


      <div class="title">Taskit</div>
      <div class="tagline-search-wrapper">

      <div class="c tagline">To-do list in JS</div>
        <div class = "header-search-field">
          <input type="search" id="search-keywords" placeholder="Search">
        </div>
      </div>
    </header>
    <div class="notes-container">
      <ul id="notes-list" class="notes-list">
        <!-- <li class="note">This is a todo item</li> -->
        <!-- <li class="note">This is a todo item 2</li> -->
        <!-- <li class="note">This is a todo item 3</li> -->
      </ul>
      <input type="text" placeholder="New to-do" id="new-note-input"/>
      <button type="#" id="add-note" onclick="createNote()">Create Note</button>
      <button type="#" id="displayArray" onclick="displayArray()">Console Log Array</button>
    </div>

    <script>
        function Note(id,title,description,done){
          this.id=id;
          this.title=title;
          this.description=description;
          this.done=done;

          this.isDone = function(){
            return done;
          }
          this.toString = function(){
            return "Note #" + this.id + " : " + this.title + " : " + this.description + " Completed?: "+ this.done;
          }
          this.createListItem = function(){
            var li = document.createElement('li');
            var noteDiv = document.createElement('div');
            noteDiv.className += "notediv";
            var title = document.createElement('h4');
            title.innerHTML = this.title;
            noteDiv.appendChild(title);
            var note = this;
            var description = document.createElement('h6');
            description.innerHTML = this.description;

            var checkbox = document.createElement('input');
            checkbox.className+="cb";
            checkbox.setAttribute("type","checkbox");
            checkbox.addEventListener("click", function(){
              note.done = !note.done;
              if(note.done){
                title.style.textDecoration="line-through";
                description.style.textDecoration="line-through";

              }
              else{
                title.style.textDecoration="none";
                description.style.textDecoration = "none";
              }
              console.log("this is " + this);
                console.log("note is " + note);
              var div = document.createElement('li');

              //TODO Why is this != the note but is = li element
              div.innerHTML = note.title + " was clicked";
              var notesList = document.getElementById("notes-list");
              // notesList.appendChild(div);

            });
            noteDiv.appendChild(checkbox);

            noteDiv.appendChild(description);


            li.setAttribute("desc",this.description);
            li.setAttribute("id","note"+this.id);
            li.setAttribute("done",this.done)

            li.className+="note";
            li.appendChild(noteDiv);
            return li;
          }
          this.click = function(){
            console.log("this is " + this);
              // console.log("note is " + note);
            var div = document.createElement('li');
            div.innerHTML = this.description;
            var notesList = document.getElementById("notes-list");
            notesList.appendChild(div);
          }
        }

        var note1 = new Note(1,"This is a dynamic note title","Lorem ipsum all that bs",false);
        var note2 = new Note(2,"This is a dynamic note title #2","Lorem ipsum all that bs",false);
        var notesArray = [note1,note2];

        for(i in notesArray){
          note = notesArray[i];
          appendNewNote(note);
          // var li = note.createListItem();
          // var notesList = document.getElementById("notes-list");
          // notesList.appendChild(note.createListItem());
        }

        function displayArray(){
          console.log('display array called');
          for(i in notesArray){
            note = notesArray[i];
            console.log(note.toString());
          }
        }
        function createNote(){
          var inputEle = document.getElementById("new-note-input")
          var newTitle = inputEle.value;
          inputEle.value = "";
          var newNote = new Note(5,newTitle,"Self created description",false);
          appendNewNote(newNote);
        }
        function appendNewNote(note){
          var notesList = document.getElementById("notes-list");
          notesList.appendChild(note.createListItem());

        }


    </script>
  </body>
</html>
